{"entries":[{"timestamp":1769780990228,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":2930,"diffs":[[1,"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":568,"diffs":[[1,"\n"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":116,"length1":122,"diffs":[[1,"        \"microphone\": \"*\"\n"]]},{"start1":233,"length1":35,"diffs":[[1,"    \"additionalFilePaths\": []\n"]]}]}]},{"timestamp":1769781573566,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":4571,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables></variables><block type=\"pxt-on-start\" x=\"11\" y=\"40\"><statement name=\"HANDLER\"><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Heart</field></block></statement></block><block type=\"device_forever\" x=\"285\" y=\"32\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><statement name=\"DO0\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Forward</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" label=\"Speed\" precision=\"0\"></mutation><field name=\"SLIDER\">2</field></shadow></value></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_off\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field></block></statement><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">m.x</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.X</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">m.y</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Y</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">c</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"binary\"></mutation><field name=\"OP\">atan2</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Y</field></block></value><value name=\"ARG1\"><shadow type=\"math_number\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.X</field></block></value></block></value></block></next></block></next></block></next></block></statement></block><block type=\"serial_writevalue\" disabled-reasons=\"pxt_automatic_disabled\" x=\"730\" y=\"491\"><value name=\"name\"><shadow type=\"text\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"TEXT\">m.z</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"NAME\">Dimension.Z</field></block></value></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":43,"diffs":[[1,""]]},{"start1":332,"length1":327,"diffs":[[1,"    serial.writeValue(\"m.x\", input.magneticForce(Dimension.X))\n    serial.writeValue(\"m.y\", input.magneticForce(Dimension.Y))\n    serial.writeValue(\"c\", Math.atan2(input.magneticForce(Dimension.Y), input.magneticForce(Dimension.X)))\n"]]}]}]},{"timestamp":1769782010136,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":6864,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\",Gnpl!clA7dFx|R2IzIe\">xComp</variable><variable id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</variable><variable id=\"vkdDF}~S6bQ#cLUpLr|{\">yComp</variable></variables><block type=\"pxt-on-start\" x=\"11\" y=\"40\"><statement name=\"HANDLER\"><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Heart</field></block></statement></block><block type=\"device_forever\" x=\"285\" y=\"32\"><statement name=\"HANDLER\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><statement name=\"DO0\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Forward</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" label=\"Speed\" precision=\"0\"></mutation><field name=\"SLIDER\">2</field></shadow></value></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_off\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field></block></statement><next><block type=\"variables_set\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Strength</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\",Gnpl!clA7dFx|R2IzIe\">xComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.X</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"vkdDF}~S6bQ#cLUpLr|{\">yComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.X</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field></block></value></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">magAbs</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">m.x</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\",Gnpl!clA7dFx|R2IzIe\">xComp</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">m.y</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vkdDF}~S6bQ#cLUpLr|{\">yComp</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">c</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"binary\"></mutation><field name=\"OP\">atan2</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vkdDF}~S6bQ#cLUpLr|{\">yComp</field></block></value><value name=\"ARG1\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field></block></value></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":31,"diffs":[[1,""]]},{"start1":103,"length1":0,"diffs":[[1,"    if (input.buttonIsPressed(Button.A)) {\n        Kitronik_Robotics_Board.motorOn(Kitronik_Robotics_Board.Motors.Motor1, Kitronik_Robotics_Board.MotorDirection.Forward, 2)\n    } else {\n        Kitronik_Robotics_Board.motorOff(Kitronik_Robotics_Board.Motors.Motor1)\n    }\n"]]},{"start1":482,"length1":148,"diffs":[[1,"    yComp = input.magneticForce(Dimension.X) / magAbs\n"]]},{"start1":648,"length1":538,"diffs":[[1,"    serial.writeValue(\"c\", Math.atan2(yComp, magAbs))\n"]]}]}]},{"timestamp":1769782577799,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":17105,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\",Gnpl!clA7dFx|R2IzIe\">xComp</variable><variable id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</variable><variable id=\"vkdDF}~S6bQ#cLUpLr|{\">yComp</variable><variable id=\"Rf(_V)05E2OgM%So(RV-\">zComp</variable><variable id=\"v6snF_0,H^(nc4;l1A8n\">rotAngle</variable></variables><block type=\"device_forever\" x=\"285\" y=\"32\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Strength</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\",Gnpl!clA7dFx|R2IzIe\">xComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.X</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"vkdDF}~S6bQ#cLUpLr|{\">yComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Y</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"Rf(_V)05E2OgM%So(RV-\">zComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Z</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"v6snF_0,H^(nc4;l1A8n\">rotAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"binary\"></mutation><field name=\"OP\">atan2</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vkdDF}~S6bQ#cLUpLr|{\">yComp</field></block></value><value name=\"ARG1\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\",Gnpl!clA7dFx|R2IzIe\">xComp</field></block></value></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">magAbs</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">m.x</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\",Gnpl!clA7dFx|R2IzIe\">xComp</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">m.y</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vkdDF}~S6bQ#cLUpLr|{\">yComp</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">m.z</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Rf(_V)05E2OgM%So(RV-\">zComp</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">c</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"v6snF_0,H^(nc4;l1A8n\">rotAngle</field></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><statement name=\"DO0\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"v6snF_0,H^(nc4;l1A8n\">rotAngle</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Reverse</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" label=\"Speed\" precision=\"0\"></mutation><field name=\"SLIDER\">2</field></shadow></value></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Forward</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" label=\"Speed\" precision=\"0\"></mutation><field name=\"SLIDER\">2</field></shadow></value></block></statement></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_off\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field></block></statement></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"pxt-on-start\" x=\"52\" y=\"52\"><statement name=\"HANDLER\"><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Heart</field></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":575,"diffs":[[1,""]]},{"start1":74,"length1":146,"diffs":[[1,""]]},{"start1":106,"length1":28,"diffs":[[1,""]]},{"start1":389,"length1":96,"diffs":[[1,"    serial.writeValue(\"magAbs\", magAbs)\n    serial.writeValue(\"m.x\", xComp)\n    serial.writeValue(\"m.y\", yComp)\n    serial.writeValue(\"m.z\", zComp)\n"]]},{"start1":574,"length1":35,"diffs":[[1,""]]},{"start1":617,"length1":173,"diffs":[[1,"        if (rotAngle < 0) {\n            Kitronik_Robotics_Board.motorOn(Kitronik_Robotics_Board.Motors.Motor1, Kitronik_Robotics_Board.MotorDirection.Reverse, 2)\n"]]},{"start1":796,"length1":148,"diffs":[[1,"            Kitronik_Robotics_Board.motorOn(Kitronik_Robotics_Board.Motors.Motor1, Kitronik_Robotics_Board.MotorDirection.Forward, 2)\n"]]}]}]},{"timestamp":1769783074452,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":22155,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"mz:|KqTGR;quw8rP)ir]\">magAbs</variable><variable id=\"TJ#zs[mq[N(wEm+UH;]H\">xComp</variable><variable id=\"ILZwEFiqxq=zkc92ILt3\">yComp</variable><variable id=\"@M8O)@?KH3b#f]-~u$kl\">zComp</variable><variable id=\"UMsN(x~tIrdxh!*c]AeC\">rotAngle</variable><variable id=\"u^!S4!*90KU.Y;I*@Pp^\">speed</variable><variable id=\"W0cWd6:f+R]R$!shLbHu\">error</variable><variable id=\"!3F+z=IK!Rgq-Ya_eV(i\">P</variable><variable id=\"Y=MGV{P9_sk?TV0GKWFp\">kp</variable><variable id=\"JMjGtj7!5L1W#3P/AlVm\">integral</variable><variable id=\"TV[N]xeL*5bAbDgwk7o2\">I</variable><variable id=\"v,@7[sP%!8v/ey.9PSd~\">ki</variable><variable id=\"LokN^nOOPNT8Z1q}NE4s\">derivative</variable><variable id=\":|QjYFnfmqbS^vs;Z6{Z\">lastError</variable><variable id=\"N)bNe;2fG15rG~?hs81?\">D</variable><variable id=\"b#${U/(Z*WbIB8rl{_pJ\">kd</variable><variable id=\"/UbC0X,e/_gZ}z(I+y=v\">output</variable></variables><block type=\"pxt-on-start\" x=\"20\" y=\"20\"><statement name=\"HANDLER\"><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Heart</field><next><block type=\"variables_set\"><field name=\"VAR\" id=\"Y=MGV{P9_sk?TV0GKWFp\">kp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">1.2</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"v,@7[sP%!8v/ey.9PSd~\">ki</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0.01</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"b#${U/(Z*WbIB8rl{_pJ\">kd</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0.1</field></shadow></value></block></next></block></next></block></next></block></statement></block><block type=\"device_forever\" x=\"283\" y=\"20\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"mz:|KqTGR;quw8rP)ir]\">magAbs</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Strength</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"TJ#zs[mq[N(wEm+UH;]H\">xComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.X</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"mz:|KqTGR;quw8rP)ir]\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"ILZwEFiqxq=zkc92ILt3\">yComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Y</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"mz:|KqTGR;quw8rP)ir]\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"@M8O)@?KH3b#f]-~u$kl\">zComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Z</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"mz:|KqTGR;quw8rP)ir]\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"UMsN(x~tIrdxh!*c]AeC\">rotAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"binary\"></mutation><field name=\"OP\">atan2</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"ILZwEFiqxq=zkc92ILt3\">yComp</field></block></value><value name=\"ARG1\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"TJ#zs[mq[N(wEm+UH;]H\">xComp</field></block></value></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">p.P</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"!3F+z=IK!Rgq-Ya_eV(i\">P</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">p.I</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"TV[N]xeL*5bAbDgwk7o2\">I</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">p.D</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"N)bNe;2fG15rG~?hs81?\">D</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">c</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"UMsN(x~tIrdxh!*c]AeC\">rotAngle</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"u^!S4!*90KU.Y;I*@Pp^\">speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"updatePID\" functionid=\"ElScCz%mI[r~ti~MdXi^\"><arg name=\"target\" id=\"wup2fa4hvdbd5ttcw5ztz\" type=\"number\"></arg><arg name=\"current\" id=\"re79izd4h8tekxuiry5y3u\" type=\"number\"></arg></mutation><value name=\"wup2fa4hvdbd5ttcw5ztz\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><value name=\"re79izd4h8tekxuiry5y3u\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"UMsN(x~tIrdxh!*c]AeC\">rotAngle</field></block></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><statement name=\"DO0\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"u^!S4!*90KU.Y;I*@Pp^\">speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Reverse</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"u^!S4!*90KU.Y;I*@Pp^\">speed</field></block></value></block></value></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Forward</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"u^!S4!*90KU.Y;I*@Pp^\">speed</field></block></value></block></value></block></statement></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_off\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field></block></statement></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"function_definition\" x=\"1219\" y=\"20\"><mutation name=\"updatePID\" functionid=\"ElScCz%mI[r~ti~MdXi^\"><arg name=\"target\" id=\"wup2fa4hvdbd5ttcw5ztz\" type=\"number\"></arg><arg name=\"current\" id=\"re79izd4h8tekxuiry5y3u\" type=\"number\"></arg></mutation><field name=\"function_name\">updatePID</field><value name=\"wup2fa4hvdbd5ttcw5ztz\"><block type=\"argument_reporter_number\" deletable=\"false\"><field name=\"VALUE\">target</field></block></value><value name=\"re79izd4h8tekxuiry5y3u\"><block type=\"argument_reporter_number\" deletable=\"false\"><field name=\"VALUE\">current</field></block></value><statement name=\"STACK\"><block type=\"variables_set\"><field name=\"VAR\" id=\"W0cWd6:f+R]R$!shLbHu\">error</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">target</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">current</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"!3F+z=IK!Rgq-Ya_eV(i\">P</field><comment pinned=\"false\" h=\"80\" w=\"160\">1. Proportional: Direct response to error</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Y=MGV{P9_sk?TV0GKWFp\">kp</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"W0cWd6:f+R]R$!shLbHu\">error</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"JMjGtj7!5L1W#3P/AlVm\">integral</field><comment pinned=\"false\" h=\"80\" w=\"160\">2. Integral: Fixes long-term drift (with clamping to prevent \"windup\")</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"JMjGtj7!5L1W#3P/AlVm\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"W0cWd6:f+R]R$!shLbHu\">error</field></block></value></block></value><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"JMjGtj7!5L1W#3P/AlVm\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"JMjGtj7!5L1W#3P/AlVm\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></statement><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"JMjGtj7!5L1W#3P/AlVm\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">-100</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"JMjGtj7!5L1W#3P/AlVm\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">-100</field></shadow></value></block></statement><next><block type=\"variables_set\"><field name=\"VAR\" id=\"TV[N]xeL*5bAbDgwk7o2\">I</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"v,@7[sP%!8v/ey.9PSd~\">ki</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"JMjGtj7!5L1W#3P/AlVm\">integral</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"LokN^nOOPNT8Z1q}NE4s\">derivative</field><comment pinned=\"false\" h=\"80\" w=\"160\">3. Derivative: Dampens \"bouncing\"</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"W0cWd6:f+R]R$!shLbHu\">error</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\":|QjYFnfmqbS^vs;Z6{Z\">lastError</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"N)bNe;2fG15rG~?hs81?\">D</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"b#${U/(Z*WbIB8rl{_pJ\">kd</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"LokN^nOOPNT8Z1q}NE4s\">derivative</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\":|QjYFnfmqbS^vs;Z6{Z\">lastError</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"W0cWd6:f+R]R$!shLbHu\">error</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"/UbC0X,e/_gZ}z(I+y=v\">output</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"!3F+z=IK!Rgq-Ya_eV(i\">P</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"TV[N]xeL*5bAbDgwk7o2\">I</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"N)bNe;2fG15rG~?hs81?\">D</field></block></value></block></value><next><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"/UbC0X,e/_gZ}z(I+y=v\">output</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"variables_set\" disabled-reasons=\"pxt_automatic_disabled\" x=\"335\" y=\"1111\"><field name=\"VAR\" id=\"u^!S4!*90KU.Y;I*@Pp^\">speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_map\" disabled-reasons=\"pxt_automatic_disabled\"><value name=\"value\"><block type=\"math_op3\" disabled-reasons=\"pxt_automatic_disabled\"><value name=\"x\"><block type=\"variables_get\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"VAR\" id=\"UMsN(x~tIrdxh!*c]AeC\">rotAngle</field></block></value></block></value><value name=\"fromLow\"><shadow type=\"math_number\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"NUM\">0</field></shadow></value><value name=\"fromHigh\"><shadow type=\"math_number\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"NUM\">3</field></shadow></value><value name=\"toLow\"><shadow type=\"math_number\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"NUM\">0</field></shadow></value><value name=\"toHigh\"><shadow type=\"math_number\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"NUM\">10</field></shadow></value></block></value></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":378,"diffs":[[1,"function updatePID (target: number, current: number) {\n    error = target - current\n"]]},{"start1":762,"length1":26,"diffs":[[1,""]]},{"start1":795,"length1":149,"diffs":[[1,""]]},{"start1":1271,"length1":36,"diffs":[[1,"    speed = updatePID(0, rotAngle)\n"]]}]}]},{"timestamp":1769783599290,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":5122,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"(1T`=f;8SeIQGH`N+~do\">dot</variable><variable id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</variable><variable id=\"3^#~l{0;^d0o^+ItidY4\">targetY</variable><variable id=\"UdI{3rq,[7*6QX,qa1|k\">cross</variable><variable id=\"R@7=s8NpT+ATF`(/)X7[\">error</variable><variable id=\"fwsF*J2p[OuJm;Q8h,3H\">P</variable><variable id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</variable><variable id=\"X~a_SE[zeM.2ML,UY|;]\">integral</variable><variable id=\"KG8R|kuse?a(d=cqAfS^\">I</variable><variable id=\"j,W2kf?+DwG}I17#yyA8\">ki</variable><variable id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</variable><variable id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</variable><variable id=\")Ieu9NZiQ~IE6e+_cE06\">D</variable><variable id=\"r+LkkqFAdUIvXy-BRkK5\">kd</variable><variable id=\"|MYMsQP_V2$B6~5.u5I5\">output</variable><variable id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</variable><variable id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</variable><variable id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</variable><variable id=\"{pA~RXGep#t_g*Nt$d!.\">zComp</variable><variable id=\"A700djGf+^%?h}]m(G^M\">rotAngle</variable><variable id=\"`H]o8%JHO(%8KI`{0ScO\">speed</variable><variable id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</variable></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">90</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"unary\"></mutation><field name=\"OP\">cos</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"Math__constant\"><field name=\"MEMBER\">Math.PI</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">180</field></shadow></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"3^#~l{0;^d0o^+ItidY4\">targetY</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"unary\"></mutation><field name=\"OP\">sin</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"Math__constant\"><field name=\"MEMBER\">Math.PI</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">180</field></shadow></value></block></value></block></value><next><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Heart</field><next><block type=\"variables_set\"><field name=\"VAR\" id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">1.2</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"j,W2kf?+DwG}I17#yyA8\">ki</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0.01</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"r+LkkqFAdUIvXy-BRkK5\">kd</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0.1</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"function_definition\" x=\"1199\" y=\"0\"><mutation name=\"updatePID\" functionid=\"[k(z0-VrWPkArYe?0Aok\"><arg name=\"mx\" id=\"52q99dbrvowy0sfhz7olh\" type=\"number\"></arg><arg name=\"my\" id=\"rd18y1fudpk20ci1zd8e\" type=\"number\"></arg></mutation><field name=\"function_name\">updatePID</field><value name=\"52q99dbrvowy0sfhz7olh\"><block type=\"argument_reporter_number\" deletable=\"false\"><field name=\"VALUE\">mx</field></block></value><value name=\"rd18y1fudpk20ci1zd8e\"><block type=\"argument_reporter_number\" deletable=\"false\"><field name=\"VALUE\">my</field></block></value><statement name=\"STACK\"><block type=\"variables_set\"><field name=\"VAR\" id=\"(1T`=f;8SeIQGH`N+~do\">dot</field><comment pinned=\"false\" h=\"80\" w=\"160\">1. Complex multiplication to find the rotational difference\n"]]},{"start1":9091,"length1":13058,"diffs":[[1,"1. Proportional: Direct response to error</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><comment pinned=\"false\" h=\"80\" w=\"160\">2. Integral: Fixes long-term drift (with clamping to prevent \"windup\")</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value></block></value><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></statement><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">-100</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">-100</field></shadow></value></block></statement><next><block type=\"variables_set\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"j,W2kf?+DwG}I17#yyA8\">ki</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</field><comment pinned=\"false\" h=\"80\" w=\"160\">3. Derivative: Dampens \"bouncing\"</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"r+LkkqFAdUIvXy-BRkK5\">kd</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"|MYMsQP_V2$B6~5.u5I5\">output</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"fwsF*J2p[OuJm;Q8h,3H\">P</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field></block></value></block></value><next><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"|MYMsQP_V2$B6~5.u5I5\">output</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"device_forever\" x=\"443\" y=\"261\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Strength</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.X</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Y</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{pA~RXGep#t_g*Nt$d!.\">zComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Z</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"A700djGf+^%?h}]m(G^M\">rotAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"binary\"></mutation><field name=\"OP\">atan2</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field></block></value><value name=\"ARG1\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field></block></value></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">p.P</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"fwsF*J2p[OuJm;Q8h,3H\">P</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">p.I</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">p.D</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">c</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A700djGf+^%?h}]m(G^M\">rotAngle</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"updatePID\" functionid=\"[k(z0-VrWPkArYe?0Aok\"><arg name=\"mx\" id=\"52q99dbrvowy0sfhz7olh\" type=\"number\"></arg><arg name=\"my\" id=\"rd18y1fudpk20ci1zd8e\" type=\"number\"></arg></mutation><value name=\"52q99dbrvowy0sfhz7olh\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field></block></value><value name=\"rd18y1fudpk20ci1zd8e\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field></block></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><statement name=\"DO0\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Reverse</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value></block></value></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Forward</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value></block></value></block></statement></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_off\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field></block></statement></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":1296,"length1":16,"diffs":[[1,"kp = 1.2\nki = 0.01\n"]]},{"start1":1607,"length1":90,"diffs":[[1,"    serial.writeValue(\"p.P\", P)\n    serial.writeValue(\"p.I\", I)\n    serial.writeValue(\"p.D\", D)\n"]]},{"start1":1740,"length1":0,"diffs":[[1,"    speed = updatePID(xComp, yComp)\n"]]},{"start1":1819,"length1":65,"diffs":[[1,"        if (speed < 0) {\n"]]}]}]},{"timestamp":1769784176208,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":5126,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"(1T`=f;8SeIQGH`N+~do\">dot</variable><variable id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</variable><variable id=\"3^#~l{0;^d0o^+ItidY4\">targetY</variable><variable id=\"UdI{3rq,[7*6QX,qa1|k\">cross</variable><variable id=\"R@7=s8NpT+ATF`(/)X7[\">error</variable><variable id=\"fwsF*J2p[OuJm;Q8h,3H\">P</variable><variable id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</variable><variable id=\"X~a_SE[zeM.2ML,UY|;]\">integral</variable><variable id=\"KG8R|kuse?a(d=cqAfS^\">I</variable><variable id=\"j,W2kf?+DwG}I17#yyA8\">ki</variable><variable id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</variable><variable id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</variable><variable id=\")Ieu9NZiQ~IE6e+_cE06\">D</variable><variable id=\"r+LkkqFAdUIvXy-BRkK5\">kd</variable><variable id=\"|MYMsQP_V2$B6~5.u5I5\">output</variable><variable id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</variable><variable id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</variable><variable id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</variable><variable id=\"{pA~RXGep#t_g*Nt$d!.\">zComp</variable><variable id=\"A700djGf+^%?h}]m(G^M\">rotAngle</variable><variable id=\"`H]o8%JHO(%8KI`{0ScO\">speed</variable><variable id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</variable></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">90</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"unary\"></mutation><field name=\"OP\">cos</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"Math__constant\"><field name=\"MEMBER\">Math.PI</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">180</field></shadow></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"3^#~l{0;^d0o^+ItidY4\">targetY</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"unary\"></mutation><field name=\"OP\">sin</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"Math__constant\"><field name=\"MEMBER\">Math.PI</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">180</field></shadow></value></block></value></block></value><next><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Heart</field><next><block type=\"variables_set\"><field name=\"VAR\" id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0.2</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"j,W2kf?+DwG}I17#yyA8\">ki</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"r+LkkqFAdUIvXy-BRkK5\">kd</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0.1</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"function_definition\" x=\"1199\" y=\"0\"><mutation name=\"updatePID\" functionid=\"[k(z0-VrWPkArYe?0Aok\"><arg name=\"mx\" id=\"52q99dbrvowy0sfhz7olh\" type=\"number\"></arg><arg name=\"my\" id=\"rd18y1fudpk20ci1zd8e\" type=\"number\"></arg></mutation><field name=\"function_name\">updatePID</field><value name=\"52q99dbrvowy0sfhz7olh\"><block type=\"argument_reporter_number\" deletable=\"false\"><field name=\"VALUE\">mx</field></block></value><value name=\"rd18y1fudpk20ci1zd8e\"><block type=\"argument_reporter_number\" deletable=\"false\"><field name=\"VALUE\">my</field></block></value><statement name=\"STACK\"><block type=\"variables_set\"><field name=\"VAR\" id=\"(1T`=f;8SeIQGH`N+~do\">dot</field><comment pinned=\"false\" h=\"80\" w=\"160\">1. Complex multiplication to find the rotational difference\n"]]},{"start1":9088,"length1":14235,"diffs":[[1,"1. Proportional: Direct response to error</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><comment pinned=\"false\" h=\"80\" w=\"160\">2. Integral: Fixes long-term drift (with clamping to prevent \"windup\")</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value></block></value><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></statement><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">-100</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">-100</field></shadow></value></block></statement><next><block type=\"variables_set\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"j,W2kf?+DwG}I17#yyA8\">ki</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</field><comment pinned=\"false\" h=\"80\" w=\"160\">3. Derivative: Dampens \"bouncing\"</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"r+LkkqFAdUIvXy-BRkK5\">kd</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"|MYMsQP_V2$B6~5.u5I5\">output</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"fwsF*J2p[OuJm;Q8h,3H\">P</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field></block></value></block></value><next><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"|MYMsQP_V2$B6~5.u5I5\">output</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"device_forever\" x=\"443\" y=\"261\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Strength</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.X</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Y</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{pA~RXGep#t_g*Nt$d!.\">zComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Z</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"A700djGf+^%?h}]m(G^M\">rotAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"binary\"></mutation><field name=\"OP\">atan2</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field></block></value><value name=\"ARG1\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field></block></value></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">P</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"fwsF*J2p[OuJm;Q8h,3H\">P</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">I</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">D</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">c</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A700djGf+^%?h}]m(G^M\">rotAngle</field></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"updatePID\" functionid=\"[k(z0-VrWPkArYe?0Aok\"><arg name=\"mx\" id=\"52q99dbrvowy0sfhz7olh\" type=\"number\"></arg><arg name=\"my\" id=\"rd18y1fudpk20ci1zd8e\" type=\"number\"></arg></mutation><value name=\"52q99dbrvowy0sfhz7olh\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field></block></value><value name=\"rd18y1fudpk20ci1zd8e\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field></block></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Reverse</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value></block></value></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Forward</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value></block></value></block></statement></block></next></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_off\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field></block></statement></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":1296,"length1":9,"diffs":[[1,"kp = 0.2\n"]]},{"start1":1312,"length1":10,"diffs":[[1,"kd = 0.1\n"]]},{"start1":1349,"length1":1004,"diffs":[[1,"    magAbs = input.magneticForce(Dimension.Strength)\n    xComp = input.magneticForce(Dimension.X) / magAbs\n    yComp = input.magneticForce(Dimension.Y) / magAbs\n    zComp = input.magneticForce(Dimension.Z) / magAbs\n    rotAngle = Math.atan2(yComp, xComp)\n    serial.writeValue(\"P\", P)\n    serial.writeValue(\"I\", I)\n    serial.writeValue(\"D\", D)\n    serial.writeValue(\"c\", rotAngle)\n    if (input.buttonIsPressed(Button.A)) {\n        speed = updatePID(xComp, yComp)\n        if (speed > 0) {\n            Kitronik_Robotics_Board.motorOn(Kitronik_Robotics_Board.Motors.Motor1, Kitronik_Robotics_Board.MotorDirection.Reverse, Math.abs(speed))\n"]]},{"start1":2004,"length1":84,"diffs":[[1,"            Kitronik_Robotics_Board.motorOn(Kitronik_Robotics_Board.Motors.Motor1, Kitronik_Robotics_Board.MotorDirection.Forward, Math.abs(speed))\n"]]},{"start1":2162,"length1":33,"diffs":[[1,"    } else {\n        Kitronik_Robotics_Board.motorOff(Kitronik_Robotics_Board.Motors.Motor1)\n"]]}]}]},{"timestamp":1769784746908,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":5124,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"(1T`=f;8SeIQGH`N+~do\">dot</variable><variable id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</variable><variable id=\"3^#~l{0;^d0o^+ItidY4\">targetY</variable><variable id=\"UdI{3rq,[7*6QX,qa1|k\">cross</variable><variable id=\"R@7=s8NpT+ATF`(/)X7[\">error</variable><variable id=\"fwsF*J2p[OuJm;Q8h,3H\">P</variable><variable id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</variable><variable id=\"X~a_SE[zeM.2ML,UY|;]\">integral</variable><variable id=\"KG8R|kuse?a(d=cqAfS^\">I</variable><variable id=\"j,W2kf?+DwG}I17#yyA8\">ki</variable><variable id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</variable><variable id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</variable><variable id=\")Ieu9NZiQ~IE6e+_cE06\">D</variable><variable id=\"r+LkkqFAdUIvXy-BRkK5\">kd</variable><variable id=\"|MYMsQP_V2$B6~5.u5I5\">output</variable><variable id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</variable><variable id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</variable><variable id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</variable><variable id=\"{pA~RXGep#t_g*Nt$d!.\">zComp</variable><variable id=\"A700djGf+^%?h}]m(G^M\">rotAngle</variable><variable id=\"`H]o8%JHO(%8KI`{0ScO\">speed</variable><variable id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</variable></variables><block type=\"pxt-on-start\" x=\"68\" y=\"57\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">90</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"unary\"></mutation><field name=\"OP\">cos</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"Math__constant\"><field name=\"MEMBER\">Math.PI</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">180</field></shadow></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"3^#~l{0;^d0o^+ItidY4\">targetY</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"unary\"></mutation><field name=\"OP\">sin</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"Math__constant\"><field name=\"MEMBER\">Math.PI</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">180</field></shadow></value></block></value></block></value><next><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Heart</field><next><block type=\"variables_set\"><field name=\"VAR\" id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0.1</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"j,W2kf?+DwG}I17#yyA8\">ki</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"r+LkkqFAdUIvXy-BRkK5\">kd</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0.01</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"function_definition\" x=\"1567\" y=\"97\"><mutation name=\"updatePID\" functionid=\"[k(z0-VrWPkArYe?0Aok\"><arg name=\"mx\" id=\"52q99dbrvowy0sfhz7olh\" type=\"number\"></arg><arg name=\"my\" id=\"rd18y1fudpk20ci1zd8e\" type=\"number\"></arg></mutation><field name=\"function_name\">updatePID</field><value name=\"52q99dbrvowy0sfhz7olh\"><block type=\"argument_reporter_number\" deletable=\"false\"><field name=\"VALUE\">mx</field></block></value><value name=\"rd18y1fudpk20ci1zd8e\"><block type=\"argument_reporter_number\" deletable=\"false\"><field name=\"VALUE\">my</field></block></value><statement name=\"STACK\"><block type=\"variables_set\"><field name=\"VAR\" id=\"(1T`=f;8SeIQGH`N+~do\">dot</field><comment pinned=\"false\" h=\"80\" w=\"160\">1. Complex multiplication to find the rotational difference\n"]]},{"start1":9092,"length1":14235,"diffs":[[1,"1. Proportional: Direct response to error</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><comment pinned=\"false\" h=\"80\" w=\"160\">2. Integral: Fixes long-term drift (with clamping to prevent \"windup\")</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value></block></value><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></statement><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">-100</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">-100</field></shadow></value></block></statement><next><block type=\"variables_set\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"j,W2kf?+DwG}I17#yyA8\">ki</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</field><comment pinned=\"false\" h=\"80\" w=\"160\">3. Derivative: Dampens \"bouncing\"</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"r+LkkqFAdUIvXy-BRkK5\">kd</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"|MYMsQP_V2$B6~5.u5I5\">output</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"fwsF*J2p[OuJm;Q8h,3H\">P</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field></block></value></block></value><next><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"|MYMsQP_V2$B6~5.u5I5\">output</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"control_in_background\" x=\"752\" y=\"168\"><statement name=\"HANDLER\"><block type=\"device_while\"><value name=\"COND\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow></value><statement name=\"DO\"><block type=\"variables_set\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Strength</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.X</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Y</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{pA~RXGep#t_g*Nt$d!.\">zComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Z</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"A700djGf+^%?h}]m(G^M\">rotAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"binary\"></mutation><field name=\"OP\">atan2</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field></block></value><value name=\"ARG1\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field></block></value></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">P</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"fwsF*J2p[OuJm;Q8h,3H\">P</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">I</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">D</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">c</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A700djGf+^%?h}]m(G^M\">rotAngle</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">speed</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"updatePID\" functionid=\"[k(z0-VrWPkArYe?0Aok\"><arg name=\"mx\" id=\"52q99dbrvowy0sfhz7olh\" type=\"number\"></arg><arg name=\"my\" id=\"rd18y1fudpk20ci1zd8e\" type=\"number\"></arg></mutation><value name=\"52q99dbrvowy0sfhz7olh\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field></block></value><value name=\"rd18y1fudpk20ci1zd8e\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field></block></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Reverse</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op2\"><field name=\"op\">max</field><value name=\"x\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value><value name=\"y\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value></block></value></block></value></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Forward</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op2\"><field name=\"op\">max</field><value name=\"x\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value><value name=\"y\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value></block></value></block></value></block></statement></block></next></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_off\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field></block></statement><next><block type=\"control_wait_us\"><value name=\"micros\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"6000\" label=\"Micros\" precision=\"0\"></mutation><field name=\"SLIDER\">1000</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></statement></block><block type=\"device_forever\" x=\"443\" y=\"261\"></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":1296,"length1":10,"diffs":[[1,"kp = 0.1\n"]]},{"start1":1312,"length1":7,"diffs":[[1,"kd = 0.01\n"]]},{"start1":1684,"length1":0,"diffs":[[1,"        serial.writeValue(\"P\", P)\n        serial.writeValue(\"I\", I)\n        serial.writeValue(\"D\", D)\n        serial.writeValue(\"c\", rotAngle)\n        serial.writeValue(\"speed\", speed)\n"]]},{"start1":2465,"length1":185,"diffs":[[1,""]]}]}]},{"timestamp":1769785328023,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":12365,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"(1T`=f;8SeIQGH`N+~do\">dot</variable><variable id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</variable><variable id=\"3^#~l{0;^d0o^+ItidY4\">targetY</variable><variable id=\"UdI{3rq,[7*6QX,qa1|k\">cross</variable><variable id=\"R@7=s8NpT+ATF`(/)X7[\">error</variable><variable id=\"fwsF*J2p[OuJm;Q8h,3H\">P</variable><variable id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</variable><variable id=\"X~a_SE[zeM.2ML,UY|;]\">integral</variable><variable id=\"KG8R|kuse?a(d=cqAfS^\">I</variable><variable id=\"j,W2kf?+DwG}I17#yyA8\">ki</variable><variable id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</variable><variable id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</variable><variable id=\")Ieu9NZiQ~IE6e+_cE06\">D</variable><variable id=\"r+LkkqFAdUIvXy-BRkK5\">kd</variable><variable id=\"|MYMsQP_V2$B6~5.u5I5\">output</variable><variable id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</variable><variable id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</variable><variable id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</variable><variable id=\"{pA~RXGep#t_g*Nt$d!.\">zComp</variable><variable id=\"A700djGf+^%?h}]m(G^M\">rotAngle</variable><variable id=\"`H]o8%JHO(%8KI`{0ScO\">speed</variable><variable id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</variable></variables><block type=\"pxt-on-start\" x=\"68\" y=\"57\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">90</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"unary\"></mutation><field name=\"OP\">cos</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"Math__constant\"><field name=\"MEMBER\">Math.PI</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">180</field></shadow></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"3^#~l{0;^d0o^+ItidY4\">targetY</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"unary\"></mutation><field name=\"OP\">sin</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"Math__constant\"><field name=\"MEMBER\">Math.PI</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">180</field></shadow></value></block></value></block></value><next><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Heart</field><next><block type=\"variables_set\"><field name=\"VAR\" id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0.05</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"j,W2kf?+DwG}I17#yyA8\">ki</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"r+LkkqFAdUIvXy-BRkK5\">kd</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"function_definition\" x=\"1567\" y=\"97\"><mutation name=\"updatePID\" functionid=\"[k(z0-VrWPkArYe?0Aok\"><arg name=\"mx\" id=\"52q99dbrvowy0sfhz7olh\" type=\"number\"></arg><arg name=\"my\" id=\"rd18y1fudpk20ci1zd8e\" type=\"number\"></arg></mutation><field name=\"function_name\">updatePID</field><value name=\"52q99dbrvowy0sfhz7olh\"><block type=\"argument_reporter_number\" deletable=\"false\"><field name=\"VALUE\">mx</field></block></value><value name=\"rd18y1fudpk20ci1zd8e\"><block type=\"argument_reporter_number\" deletable=\"false\"><field name=\"VALUE\">my</field></block></value><statement name=\"STACK\"><block type=\"variables_set\"><field name=\"VAR\" id=\"(1T`=f;8SeIQGH`N+~do\">dot</field><comment pinned=\"false\" h=\"80\" w=\"160\">1. Complex multiplication to find the rotational difference\n"]]},{"start1":9090,"length1":6329,"diffs":[[1,"1. Proportional: Direct response to error</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><comment pinned=\"false\" h=\"80\" w=\"160\">2. Integral: Fixes long-term drift (with clamping to prevent \"windup\")</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value></block></value><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></statement><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">-100</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">-100</field></shadow></value></block></statement><next><block type=\"variables_set\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"j,W2kf?+DwG}I17#yyA8\">ki</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</field><comment pinned=\"false\" h=\"80\" w=\"160\">3. Derivative: Dampens \"bouncing\"</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"r+LkkqFAdUIvXy-BRkK5\">kd</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"|MYMsQP_V2$B6~5.u5I5\">output</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"fwsF*J2p[OuJm;Q8h,3H\">P</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field></block></value></block></value><next><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"|MYMsQP_V2$B6~5.u5I5\">output</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"control_in_background\" x=\"752\" y=\"168\"><statement name=\"HANDLER\"><block type=\"device_while\"><value name=\"COND\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow></value><statement name=\"DO\"><block type=\"variables_set\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Strength</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.X</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Y</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{pA~RXGep#t_g*Nt$d!.\">zComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Z</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"A700djGf+^%?h}]m(G^M\">rotAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"binary\"></mutation><field name=\"OP\">atan2</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field></block></value><value name=\"ARG1\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field></block></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"updatePID\" functionid=\"[k(z0-VrWPkArYe?0Aok\"><arg name=\"mx\" id=\"52q99dbrvowy0sfhz7olh\" type=\"number\"></arg><arg name=\"my\" id=\"rd18y1fudpk20ci1zd8e\" type=\"number\"></arg></mutation><value name=\"52q99dbrvowy0sfhz7olh\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field></block></value><value name=\"rd18y1fudpk20ci1zd8e\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field></block></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Reverse</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op2\"><field name=\"op\">max</field><value name=\"x\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value><value name=\"y\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value></block></value></block></value></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Forward</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op2\"><field name=\"op\">max</field><value name=\"x\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value><value name=\"y\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value></block></value></block></value></block></statement></block></next></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_off\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field></block></statement><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">P</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"fwsF*J2p[OuJm;Q8h,3H\">P</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">I</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">D</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">c</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A700djGf+^%?h}]m(G^M\">rotAngle</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">speed</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value><next><block type=\"control_wait_us\"><value name=\"micros\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"6000\" label=\"Micros\" precision=\"0\"></mutation><field name=\"SLIDER\">1000</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></statement></block><block type=\"device_forever\" x=\"443\" y=\"261\"></block></xml>"]]}]},{"type":"edited","filename":"main.ts","patch":[{"start1":886,"length1":0,"diffs":[[1,"let zComp = 0\n"]]},{"start1":1147,"length1":23,"diffs":[[1,"let targetAngle = 90\n"]]},{"start1":1296,"length1":29,"diffs":[[1,"kp = 0.05\nki = 0\nkd = 0\nbasic.forever(function () {\n\t\n})\n"]]},{"start1":1580,"length1":0,"diffs":[[1,"        zComp = input.magneticForce(Dimension.Z) / magAbs\n"]]}]}]},{"timestamp":1769785884404,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.blocks","patch":[{"start1":0,"length1":28481,"diffs":[[1,"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"(1T`=f;8SeIQGH`N+~do\">dot</variable><variable id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</variable><variable id=\"3^#~l{0;^d0o^+ItidY4\">targetY</variable><variable id=\"UdI{3rq,[7*6QX,qa1|k\">cross</variable><variable id=\"R@7=s8NpT+ATF`(/)X7[\">error</variable><variable id=\"fwsF*J2p[OuJm;Q8h,3H\">P</variable><variable id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</variable><variable id=\"X~a_SE[zeM.2ML,UY|;]\">integral</variable><variable id=\"KG8R|kuse?a(d=cqAfS^\">I</variable><variable id=\"j,W2kf?+DwG}I17#yyA8\">ki</variable><variable id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</variable><variable id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</variable><variable id=\")Ieu9NZiQ~IE6e+_cE06\">D</variable><variable id=\"r+LkkqFAdUIvXy-BRkK5\">kd</variable><variable id=\"|MYMsQP_V2$B6~5.u5I5\">output</variable><variable id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</variable><variable id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</variable><variable id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</variable><variable id=\"{pA~RXGep#t_g*Nt$d!.\">zComp</variable><variable id=\"A700djGf+^%?h}]m(G^M\">rotAngle</variable><variable id=\"`H]o8%JHO(%8KI`{0ScO\">speed</variable><variable id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</variable></variables><block type=\"pxt-on-start\" x=\"68\" y=\"57\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">-110</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"unary\"></mutation><field name=\"OP\">cos</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"Math__constant\"><field name=\"MEMBER\">Math.PI</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">180</field></shadow></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"3^#~l{0;^d0o^+ItidY4\">targetY</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"unary\"></mutation><field name=\"OP\">sin</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"Math__constant\"><field name=\"MEMBER\">Math.PI</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">180</field></shadow></value></block></value></block></value><next><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Heart</field><next><block type=\"variables_set\"><field name=\"VAR\" id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0.1</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"j,W2kf?+DwG}I17#yyA8\">ki</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0.001</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"r+LkkqFAdUIvXy-BRkK5\">kd</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0.5</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"control_in_background\" x=\"830\" y=\"129\"><statement name=\"HANDLER\"><block type=\"device_while\"><value name=\"COND\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow></value><statement name=\"DO\"><block type=\"variables_set\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Strength</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.X</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Y</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"A700djGf+^%?h}]m(G^M\">rotAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"binary\"></mutation><field name=\"OP\">atan2</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field></block></value><value name=\"ARG1\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field></block></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"updatePID\" functionid=\"[k(z0-VrWPkArYe?0Aok\"><arg name=\"mx\" id=\"52q99dbrvowy0sfhz7olh\" type=\"number\"></arg><arg name=\"my\" id=\"rd18y1fudpk20ci1zd8e\" type=\"number\"></arg></mutation><value name=\"52q99dbrvowy0sfhz7olh\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field></block></value><value name=\"rd18y1fudpk20ci1zd8e\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field></block></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Reverse</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op2\"><field name=\"op\">max</field><value name=\"x\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value><value name=\"y\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value></block></value></block></value></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Forward</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op2\"><field name=\"op\">max</field><value name=\"x\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value><value name=\"y\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value></block></value></block></value></block></statement></block></next></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_off\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field></block></statement><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">P</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"fwsF*J2p[OuJm;Q8h,3H\">P</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">I</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">D</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">c</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A700djGf+^%?h}]m(G^M\">rotAngle</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">speed</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value><next><block type=\"control_wait_us\"><value name=\"micros\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"6000\" label=\"Micros\" precision=\"0\"></mutation><field name=\"SLIDER\">1000</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></statement></block><block type=\"function_definition\" x=\"1746\" y=\"197\"><mutation name=\"updatePID\" functionid=\"[k(z0-VrWPkArYe?0Aok\"><arg name=\"mx\" id=\"52q99dbrvowy0sfhz7olh\" type=\"number\"></arg><arg name=\"my\" id=\"rd18y1fudpk20ci1zd8e\" type=\"number\"></arg></mutation><field name=\"function_name\">updatePID</field><value name=\"52q99dbrvowy0sfhz7olh\"><block type=\"argument_reporter_number\" deletable=\"false\"><field name=\"VALUE\">mx</field></block></value><value name=\"rd18y1fudpk20ci1zd8e\"><block type=\"argument_reporter_number\" deletable=\"false\"><field name=\"VALUE\">my</field></block></value><statement name=\"STACK\"><block type=\"variables_set\"><field name=\"VAR\" id=\"(1T`=f;8SeIQGH`N+~do\">dot</field><comment pinned=\"false\" h=\"80\" w=\"160\">1. Complex multiplication to find the rotational difference\nThis naturally handles the 360 wrap-around</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">mx</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"3^#~l{0;^d0o^+ItidY4\">targetY</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">my</field></block></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"UdI{3rq,[7*6QX,qa1|k\">cross</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"3^#~l{0;^d0o^+ItidY4\">targetY</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">mx</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">my</field></block></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field><comment pinned=\"false\" h=\"80\" w=\"160\">2. The error is the angle of that difference</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"binary\"></mutation><field name=\"OP\">atan2</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"UdI{3rq,[7*6QX,qa1|k\">cross</field></block></value><value name=\"ARG1\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"(1T`=f;8SeIQGH`N+~do\">dot</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">180</field></shadow></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"Math__constant\"><field name=\"MEMBER\">Math.PI</field></block></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"fwsF*J2p[OuJm;Q8h,3H\">P</field><comment pinned=\"false\" h=\"80\" w=\"160\">error = target - current\n1. Proportional: Direct response to error</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><comment pinned=\"false\" h=\"80\" w=\"160\">2. Integral: Fixes long-term drift (with clamping to prevent \"windup\")</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value></block></value><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></statement><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">-100</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">-100</field></shadow></value></block></statement><next><block type=\"variables_set\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"j,W2kf?+DwG}I17#yyA8\">ki</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</field><comment pinned=\"false\" h=\"80\" w=\"160\">3. Derivative: Dampens \"bouncing\"</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"r+LkkqFAdUIvXy-BRkK5\">kd</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"|MYMsQP_V2$B6~5.u5I5\">output</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"fwsF*J2p[OuJm;Q8h,3H\">P</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field></block></value></block></value><next><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"|MYMsQP_V2$B6~5.u5I5\">output</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>"]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":329,"length1":44,"diffs":[[1,""]]}]},{"type":"added","filename":"test.ts","value":"// tests go here; this will not be compiled when this package is used as an extension.\n"}]}],"snapshots":[{"timestamp":1769780990227,"editorVersion":"8.0.18","text":{"main.blocks":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>","main.ts":"\n","README.md":"","pxt.json":"{\n    \"name\": \"motor_test\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"additionalFilePaths\": []\n}\n"}},{"timestamp":1769782834855,"editorVersion":"8.0.18","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\",Gnpl!clA7dFx|R2IzIe\">xComp</variable><variable id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</variable><variable id=\"vkdDF}~S6bQ#cLUpLr|{\">yComp</variable><variable id=\"Rf(_V)05E2OgM%So(RV-\">zComp</variable><variable id=\"v6snF_0,H^(nc4;l1A8n\">rotAngle</variable><variable id=\"@Mh:NdUX6F!:jg2TmdRF\">speed</variable></variables><block type=\"device_forever\" x=\"233\" y=\"-20\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Strength</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\",Gnpl!clA7dFx|R2IzIe\">xComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.X</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"vkdDF}~S6bQ#cLUpLr|{\">yComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Y</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"Rf(_V)05E2OgM%So(RV-\">zComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\" disabled-reasons=\"pxt_automatic_disabled\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Z</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"v6snF_0,H^(nc4;l1A8n\">rotAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"binary\"></mutation><field name=\"OP\">atan2</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vkdDF}~S6bQ#cLUpLr|{\">yComp</field></block></value><value name=\"ARG1\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\",Gnpl!clA7dFx|R2IzIe\">xComp</field></block></value></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">magAbs</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"YOez7.3/T6;=3`z=C:w/\">magAbs</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">m.x</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\",Gnpl!clA7dFx|R2IzIe\">xComp</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">m.y</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"vkdDF}~S6bQ#cLUpLr|{\">yComp</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">m.z</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Rf(_V)05E2OgM%So(RV-\">zComp</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">c</field></shadow></value><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"v6snF_0,H^(nc4;l1A8n\">rotAngle</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"@Mh:NdUX6F!:jg2TmdRF\">speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_map\"><value name=\"value\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"v6snF_0,H^(nc4;l1A8n\">rotAngle</field></block></value></block></value><value name=\"fromLow\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><value name=\"fromHigh\"><shadow type=\"math_number\"><field name=\"NUM\">3</field></shadow></value><value name=\"toLow\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><value name=\"toHigh\"><shadow type=\"math_number\"><field name=\"NUM\">10</field></shadow></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><statement name=\"DO0\"><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"v6snF_0,H^(nc4;l1A8n\">rotAngle</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Reverse</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" label=\"Speed\" precision=\"0\"></mutation><field name=\"SLIDER\">2</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"@Mh:NdUX6F!:jg2TmdRF\">speed</field></block></value></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Forward</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" label=\"Speed\" precision=\"0\"></mutation><field name=\"SLIDER\">2</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"@Mh:NdUX6F!:jg2TmdRF\">speed</field></block></value></block></statement></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_off\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field></block></statement></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Heart</field></block></statement></block></xml>","main.ts":"let speed = 0\nlet rotAngle = 0\nlet zComp = 0\nlet yComp = 0\nlet xComp = 0\nlet magAbs = 0\nbasic.showIcon(IconNames.Heart)\nbasic.forever(function () {\n    magAbs = input.magneticForce(Dimension.Strength)\n    xComp = input.magneticForce(Dimension.X) / magAbs\n    yComp = input.magneticForce(Dimension.Y) / magAbs\n    zComp = input.magneticForce(Dimension.Z) / magAbs\n    rotAngle = Math.atan2(yComp, xComp)\n    serial.writeValue(\"magAbs\", magAbs)\n    serial.writeValue(\"m.x\", xComp)\n    serial.writeValue(\"m.y\", yComp)\n    serial.writeValue(\"m.z\", zComp)\n    serial.writeValue(\"c\", rotAngle)\n    speed = Math.map(Math.abs(rotAngle), 0, 3, 0, 10)\n    if (input.buttonIsPressed(Button.A)) {\n        if (rotAngle < 0) {\n            Kitronik_Robotics_Board.motorOn(Kitronik_Robotics_Board.Motors.Motor1, Kitronik_Robotics_Board.MotorDirection.Reverse, speed)\n        } else {\n            Kitronik_Robotics_Board.motorOn(Kitronik_Robotics_Board.Motors.Motor1, Kitronik_Robotics_Board.MotorDirection.Forward, speed)\n        }\n    } else {\n        Kitronik_Robotics_Board.motorOff(Kitronik_Robotics_Board.Motors.Motor1)\n    }\n})\n","README.md":"","pxt.json":"{\n    \"name\": \"motor_test\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\",\n        \"pxt-kitronik-robotics-board\": \"github:kitronikltd/pxt-kitronik-robotics-board#v0.1.1\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"preferredEditor\": \"tsprj\"\n}\n"}},{"timestamp":1769784705240,"editorVersion":"8.0.18","text":{"main.blocks":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"(1T`=f;8SeIQGH`N+~do\">dot</variable><variable id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</variable><variable id=\"3^#~l{0;^d0o^+ItidY4\">targetY</variable><variable id=\"UdI{3rq,[7*6QX,qa1|k\">cross</variable><variable id=\"R@7=s8NpT+ATF`(/)X7[\">error</variable><variable id=\"fwsF*J2p[OuJm;Q8h,3H\">P</variable><variable id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</variable><variable id=\"X~a_SE[zeM.2ML,UY|;]\">integral</variable><variable id=\"KG8R|kuse?a(d=cqAfS^\">I</variable><variable id=\"j,W2kf?+DwG}I17#yyA8\">ki</variable><variable id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</variable><variable id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</variable><variable id=\")Ieu9NZiQ~IE6e+_cE06\">D</variable><variable id=\"r+LkkqFAdUIvXy-BRkK5\">kd</variable><variable id=\"|MYMsQP_V2$B6~5.u5I5\">output</variable><variable id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</variable><variable id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</variable><variable id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</variable><variable id=\"{pA~RXGep#t_g*Nt$d!.\">zComp</variable><variable id=\"A700djGf+^%?h}]m(G^M\">rotAngle</variable><variable id=\"`H]o8%JHO(%8KI`{0ScO\">speed</variable><variable id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</variable></variables><block type=\"pxt-on-start\" x=\"0\" y=\"0\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">90</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"unary\"></mutation><field name=\"OP\">cos</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"Math__constant\"><field name=\"MEMBER\">Math.PI</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">180</field></shadow></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"3^#~l{0;^d0o^+ItidY4\">targetY</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"unary\"></mutation><field name=\"OP\">sin</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"%+NtJL/=LfAMLcnl(VRo\">targetAngle</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"Math__constant\"><field name=\"MEMBER\">Math.PI</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">180</field></shadow></value></block></value></block></value><next><block type=\"basic_show_icon\"><field name=\"i\">IconNames.Heart</field><next><block type=\"variables_set\"><field name=\"VAR\" id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0.1</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"j,W2kf?+DwG}I17#yyA8\">ki</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"r+LkkqFAdUIvXy-BRkK5\">kd</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0.01</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"function_definition\" x=\"1567\" y=\"97\"><mutation name=\"updatePID\" functionid=\"[k(z0-VrWPkArYe?0Aok\"><arg name=\"mx\" id=\"52q99dbrvowy0sfhz7olh\" type=\"number\"></arg><arg name=\"my\" id=\"rd18y1fudpk20ci1zd8e\" type=\"number\"></arg></mutation><field name=\"function_name\">updatePID</field><value name=\"52q99dbrvowy0sfhz7olh\"><block type=\"argument_reporter_number\" deletable=\"false\"><field name=\"VALUE\">mx</field></block></value><value name=\"rd18y1fudpk20ci1zd8e\"><block type=\"argument_reporter_number\" deletable=\"false\"><field name=\"VALUE\">my</field></block></value><statement name=\"STACK\"><block type=\"variables_set\"><field name=\"VAR\" id=\"(1T`=f;8SeIQGH`N+~do\">dot</field><comment pinned=\"false\" h=\"80\" w=\"160\">1. Complex multiplication to find the rotational difference\nThis naturally handles the 360 wrap-around</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">mx</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"3^#~l{0;^d0o^+ItidY4\">targetY</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">my</field></block></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"UdI{3rq,[7*6QX,qa1|k\">cross</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"3^#~l{0;^d0o^+ItidY4\">targetY</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">mx</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"cK=uNz+F=?6GRl^(W7^Q\">targetX</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"argument_reporter_number\"><field name=\"VALUE\">my</field></block></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field><comment pinned=\"false\" h=\"80\" w=\"160\">2. The error is the angle of that difference</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"binary\"></mutation><field name=\"OP\">atan2</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"UdI{3rq,[7*6QX,qa1|k\">cross</field></block></value><value name=\"ARG1\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"(1T`=f;8SeIQGH`N+~do\">dot</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">180</field></shadow></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"Math__constant\"><field name=\"MEMBER\">Math.PI</field></block></value></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"fwsF*J2p[OuJm;Q8h,3H\">P</field><comment pinned=\"false\" h=\"80\" w=\"160\">error = target - current\n1. Proportional: Direct response to error</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"OK1AS|;Rg}*hkG?WTXn?\">kp</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><comment pinned=\"false\" h=\"80\" w=\"160\">2. Integral: Fixes long-term drift (with clamping to prevent \"windup\")</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value></block></value><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">100</field></shadow></value></block></statement><next><block type=\"controls_if\"><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">LT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">-100</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">-100</field></shadow></value></block></statement><next><block type=\"variables_set\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"j,W2kf?+DwG}I17#yyA8\">ki</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"X~a_SE[zeM.2ML,UY|;]\">integral</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</field><comment pinned=\"false\" h=\"80\" w=\"160\">3. Derivative: Dampens \"bouncing\"</comment><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MINUS</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">MULTIPLY</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"r+LkkqFAdUIvXy-BRkK5\">kd</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"M(7AH?+8v6zTaG-9L5xB\">derivative</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"C$ThK|Ulw.|FI~0rgbcU\">lastError</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"R@7=s8NpT+ATF`(/)X7[\">error</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"|MYMsQP_V2$B6~5.u5I5\">output</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">ADD</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"fwsF*J2p[OuJm;Q8h,3H\">P</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field></block></value></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field></block></value></block></value><next><block type=\"function_return\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" no_return_value=\"false\"></mutation><value name=\"RETURN_VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"|MYMsQP_V2$B6~5.u5I5\">output</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block><block type=\"device_forever\" x=\"443\" y=\"261\"><statement name=\"HANDLER\"><block type=\"variables_set\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Strength</field></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.X</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Y</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"{pA~RXGep#t_g*Nt$d!.\">zComp</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_arithmetic\"><field name=\"OP\">DIVIDE</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"device_get_magnetic_force\"><field name=\"NAME\">Dimension.Z</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"q5FBf?iI`rk(di2_)dL5\">magAbs</field></block></value></block></value><next><block type=\"variables_set\"><field name=\"VAR\" id=\"A700djGf+^%?h}]m(G^M\">rotAngle</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_js_op\"><mutation xmlns=\"http://www.w3.org/1999/xhtml\" op-type=\"binary\"></mutation><field name=\"OP\">atan2</field><value name=\"ARG0\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field></block></value><value name=\"ARG1\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field></block></value></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">P</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"fwsF*J2p[OuJm;Q8h,3H\">P</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">I</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"KG8R|kuse?a(d=cqAfS^\">I</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">D</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\")Ieu9NZiQ~IE6e+_cE06\">D</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">c</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"A700djGf+^%?h}]m(G^M\">rotAngle</field></block></value><next><block type=\"serial_writevalue\"><value name=\"name\"><shadow type=\"text\"><field name=\"TEXT\">speed</field></shadow></value><value name=\"value\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"device_get_button2\"><field name=\"NAME\">Button.A</field></block></value><statement name=\"DO0\"><block type=\"variables_set\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field><value name=\"VALUE\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"function_call_output\"><mutation name=\"updatePID\" functionid=\"[k(z0-VrWPkArYe?0Aok\"><arg name=\"mx\" id=\"52q99dbrvowy0sfhz7olh\" type=\"number\"></arg><arg name=\"my\" id=\"rd18y1fudpk20ci1zd8e\" type=\"number\"></arg></mutation><value name=\"52q99dbrvowy0sfhz7olh\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"Mdd}!;A4P@wsRL-n:LOZ\">xComp</field></block></value><value name=\"rd18y1fudpk20ci1zd8e\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"uIRj(HKTfkfR~G$gTOmR\">yComp</field></block></value></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><shadow type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></shadow><block type=\"logic_compare\"><field name=\"OP\">GT</field><value name=\"A\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value><value name=\"B\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow></value></block></value><statement name=\"DO0\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Reverse</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op2\"><field name=\"op\">max</field><value name=\"x\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value><value name=\"y\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value></block></value></block></value></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_on\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field><field name=\"dir\">Kitronik_Robotics_Board.MotorDirection.Forward</field><value name=\"speed\"><shadow type=\"math_number_minmax\"><mutation min=\"0\" max=\"100\" precision=\"0\"></mutation><field name=\"SLIDER\">0</field></shadow><block type=\"math_op2\"><field name=\"op\">max</field><value name=\"x\"><shadow type=\"math_number\"><field name=\"NUM\">1</field></shadow></value><value name=\"y\"><shadow type=\"math_number\"><field name=\"NUM\">0</field></shadow><block type=\"math_op3\"><value name=\"x\"><block type=\"variables_get\"><field name=\"VAR\" id=\"`H]o8%JHO(%8KI`{0ScO\">speed</field></block></value></block></value></block></value></block></statement></block></next></block></statement><statement name=\"ELSE\"><block type=\"kitronik_motor_off\"><field name=\"motor\">Kitronik_Robotics_Board.Motors.Motor1</field></block></statement></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>","main.ts":"","README.md":"","pxt.json":"{\n    \"name\": \"motor_test\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\",\n        \"pxt-kitronik-robotics-board\": \"github:kitronikltd/pxt-kitronik-robotics-board#v0.1.1\"\n    },\n    \"files\": [\n        \"main.blocks\",\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"preferredEditor\": \"blocksprj\"\n}\n"}}],"shares":[],"lastSaveTime":1769785994878}